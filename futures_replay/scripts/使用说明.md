# 期货数据转换工具 使用说明

## 简介

这是一个桌面应用，用于将各种格式的期货K线数据转换为Flutter项目所需的标准格式。

## 功能特点

- ✅ 支持多种数据源格式（天勤SDK、通达信、AkShare等）
- ✅ 自动识别数据列（datetime、open、high、low、close、volume）
- ✅ 批量转换支持
- ✅ 自动命名（如RB→RB2505.csv，M→M2505.csv）
- ✅ 可视化界面，操作简单

## 打包为EXE

### 方法一：使用打包脚本（推荐）

1. 打开命令行（PowerShell或CMD）
2. 进入 `scripts` 目录
3. 运行打包脚本：

```bash
.\build_simple.bat
```

4. 等待打包完成（约1-2分钟）
5. 在 `scripts\dist` 目录找到生成的 `期货数据转换工具.exe`

### 方法二：手动打包

```bash
cd scripts
pyinstaller --onefile --windowed --name "期货数据转换工具" 简易版_csv_converter.py
```

## 使用步骤

1. **启动程序**
   - 双击 `期货数据转换工具.exe`

2. **选择文件**
   - 点击"选择单个文件"按钮（转换一个文件）
   - 或点击"选择多个文件"按钮（批量转换）

3. **自动转换**
   - 程序会自动识别数据格式
   - 转换为标准格式：`datetime, open, high, low, close, volume`
   - 保存到原文件所在目录

4. **输出文件**
   - RB（螺纹钢）→ `RB2505.csv`
   - M（豆粕）→ `M2505.csv`
   - AU（黄金）→ `AU2506.csv`
   - AG（白银）→ `AG2506.csv`
   - 其他 → `converted_原文件名.csv`

## 支持的输入格式

### 格式1：天勤SDK（TqSDK）

```csv
datetime,open,high,low,close,volume,open_oi,close_oi
2025-01-02 09:00:00,3320,3325,3318,3322,50000,100000,100500
```

### 格式2：通达信导出

```csv
时间,开盘价,最高价,最低价,收盘价,成交量
2025-01-02 09:00:00,3320,3325,3318,3322,50000
```

### 格式3：AkShare

```csv
datetime,open,high,low,close,volume
2025-01-02 09:00:00,3320,3325,3318,3322,50000
```

## 输出格式

所有数据统一转换为以下格式：

```csv
datetime,open,high,low,close,volume
2025-01-02 09:00:00,3320,3325,3318,3322,50000
2025-01-02 09:05:00,3322,3328,3320,3326,48000
...
```

## 注意事项

1. **文件编码**
   - 支持UTF-8和GBK编码
   - 如遇乱码，请先转换为UTF-8

2. **数据过滤**
   - 自动过滤 `close <= 0` 的无效数据
   - 只保留有效K线

3. **文件命名**
   - 根据文件名自动识别合约
   - 文件名需包含合约代码（如 `rb`, `m`, `au` 等）

4. **日志查看**
   - 处理过程在日志区域实时显示
   - 可点击"清空日志"按钮清除历史记录

## 常见问题

### Q: 打包后EXE文件很大（~30MB）？
A: 这是正常现象，因为打包了Python解释器和pandas库。

### Q: 杀毒软件误报？
A: PyInstaller打包的程序可能被误报，可添加信任或使用自签名证书。

### Q: 找不到列怎么办？
A: 检查CSV文件是否包含必需的列（datetime、open、high、low、close、volume）。

### Q: 转换后的文件能直接用吗？
A: 是的，转换后的CSV文件可直接在Flutter应用中导入使用。

## 技术细节

- **界面框架**: Tkinter（Python自带）
- **数据处理**: Pandas
- **打包工具**: PyInstaller
- **兼容性**: Windows 7/8/10/11

## 更新日志

### v1.0 (2026-02-17)
- 初始版本
- 支持多种格式转换
- 批量处理功能
- 自动合约识别

## 联系方式

如有问题或建议，请在项目仓库提Issue。
